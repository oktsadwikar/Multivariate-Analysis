---
title: "Multivariate Analysis Chapter 1 - 3"
author: "Oktsa Dwika R"
date: '2023-08-20'
output: github_document
editor_options: 
  markdown: 
    wrap: 72
---

# **CHAPTER 1**

## **A. Vectors and Matrices**

**The computation:**

```         
X = matrix(c(), nrow, ncol)
```

**Explaination:**

-   c() is used to input the elements of the matrix

-   nrow = the number of rows from the matrix, ex: 1, 2, 3, etc

-   ncol = the number of columns from the matrix, ex: 1, 2, 3, etc

    So, the size of the matrix is nrow x ncol.

**Example:**

```{r}
X = matrix(c(2,3,7,4),4,1)
X
```

## **B. Expectation**

### **1. Using Manual Way**

```         
# Input Part
X = c()
prob = c()

# Computation Part
Exp_X = X %*% prob
```

**Explaination:**

-   X = the value of the vector X

-   prob = probability function of X

**Example:**

```{r}
X = c(-1,0,1)
X
prob = c(0.3,0.3,0.4)
prob
```

```{r}
Exp_X = X%*%prob
Exp_X
```

### 2. Using Function

```         
# Input Part
vals = c()
probs = c()

# calculate expected value
weighted.mean(vals, probs)
```

**Explaination:**

-   vals = the value of data or observation

-   probs = probability function of observation

**Example:**

```{r}
vals = c(-1,0,1)
probs = c(0.3,0.3,0.4)
weighted.mean(vals, probs)
```

## **C. Covariance Matrix**

**The computation:**

```         
# Input Part
data = data.frame(V1 = c()
                  V2 = c()
                  ...
                  Vn = c())

# Computation Part
cov(data)
```

**Explaination:**

-   data = data frame

-   Vi = the value of variable i, where i = 1,2,...,n

**Example:**

```{r}
data = data.frame(V1 = c(84, 82, 81, 89, 73, 94, 92, 70, 88, 95),
                  V2 = c(85, 82, 72, 77, 75, 89, 95, 84, 77, 94),
                  V3 = c(97, 94, 93, 95, 88, 82, 78, 84, 69, 78))

cov(data)
```

## **D. Mean Vector and Covariance Matrix for Linear Combination of Random Variables**

In general, consider the q linear combinations of the p random variables
1,2,...,p. The computation:

```         
# Input Part
mu = matrix(c(),,)
sigma = matrix(c(),,)
C = matrix(c(),,)

# Computation Part
MuZ = C%*%mu
MuZ

SigZ = C%*%sigma%*%t(C)
SigZ
```

**Explaination:**

-   mu = the expectation or mean vector

-   sigma = the covariance matrix

-   C = the combination matrix

-   MuZ = the mean vector for Linear Combination

-   SigZ = the covariance matrix for Linear Combination

**Example:**

```{r}
mu = matrix(c(2,3,-1,5),4,1)
sigma = matrix(c(11,-8,3,9,-8,9,-3,-6,3,-3,2,3,9,6,3,9),4,4)
C = matrix(c(3,-1,2,1,-3,-2,-4,1,4,-1,-2,-5),3,4)

MuZ = C%*%mu
paste("so the mean vector for linear combination is")
MuZ

SigZ = C%*%sigma%*%t(C)
paste("so the covariance matrix for linear combination is")
SigZ
```

## **E. Data Manipulation**

For data manipulation, we will use 'dplyr' and 'tidyverse' packages.

```{r}
# Installing the package
library('dplyr')
library('tidyverse')
```

Create Data Frame for the data that will be manipulated.

```         
# Input Part
df1 = data.frame((V1 = c()
                  V2 = c()
                  ...
                  Vn = c())
df2 = data.frame((V1 = c()
                  V2 = c()
                  ...
                  Vn = c())
)
```

1.  **Inner Join Function**

```         
# Computation Part
df_ij = inner_join(df1, df2, by = " ")
df_ij
```

**Explaination :**

Merge 2 dataframe by variable inside " ", then the output will show only
for the same value of variable inside " "

2.  **Left Join using Inner Join**

```         
# Computation Part
df_ij2= df1 %>% inner_join(df2,by=" ")
df_ij2
```

3.  **Outer Join**

```         
# Computation Part
df_U = full_join(df1,df2,by = "")
df_U
```

**Explaination:**

Merge 2 dataframe by variable inside " ", then the output will show all
of the data and the missing data will show NA.

4.  **Left Join**

```         
# Computation Part
df_L = left_join(df1, df2, by=" ")
df_L
```

**Explaination:**

Combine right table (df2) to the left table (df1) by variable inside " "
from the left table (df1)

5.  **Right Join**

```         
# Computation Part
df_R = right_join(df1, df2, by=" ")
df_R
```

**Explaination:**

Combine left table (df1) to the right table (df2) by variable inside " "
from the right table (df2).

**Example 1- 5:**

```{r}
# Input part
df1=data.frame(CustomerId=c(1:6),Product=c("Oven","Television","Mobile","WashingMachine","Lightings","Ipad"),NumbProduct=c(10,5,16,2,22,7))
df1

df2=data.frame(CustomerId=c(2,4,6,7,8),State=c("California","Newyork","Santiago","Texas","Indiana"))
df2
```

```{r}
# Inner Join Function
df_ij=inner_join(df1,df2,by="CustomerId") 
df_ij
```

```{r}
# Left Join using Inner Join
df_ij2= df1 %>% inner_join(df2,by="CustomerId")
df_ij2
```

```{r}
# Outer Join
df_U = full_join(df1,df2,by="CustomerId")
df_U
```

```{r}
# Left Join
df_L = left_join(df1, df2, by="CustomerId")
df_L
```

```{r}
# Right Join
df_R = right_join(df1, df2, by="CustomerId")
df_R
```

6.  **Check Information of data**

```{r}
# Computation Part
df_U %>% glimpse()
glimpse(df_U)
df1 %>% full_join(df2, by="CustomerId") %>% glimpse()
```

7.  **Check missing data for each column**

```{r}
results = apply(is.na(df_U),2,which)
results

results2 = apply(is.na(df_L),2,which)
results2
```

**Explainatuon :**

is.na to check missing value, 2 means we check the column. if we use 1,
means we check the row

8.  **Filter out the missing values by drop_na**

```{r}
df_UC = drop_na(df_U)
df_UC
```

# **CHAPTER 2**

## **DATA EXPLORING**

**Data Exploration by DataExplorer package**

```{r}
library('DataExplorer')
```

1.  **Importing data**

```         
# Import Data
file = ''
data = read.csv(file)
```

**Explaination :**

file = ' ' is for the location of the data in the device.

**Example:**

```{r}

data = read.csv("C:/Users/Avita/Documents/Multivariate-Analysis/Data/CreditApproval.csv", header = TRUE)

head(data)
```

2.  **Check the information about the data**

```{r}
introduce(data)
miss_val = apply(is.na(data),2,which)
miss_val
```

3.  **Check the % of missing value for each variable**

```{r}
plot_missing(data)
```

4.  **Filter out the missing value**

```{r}
dataC = drop_na(data)
introduce(dataC)
```

5.  **Plotting the data**

```         
# Bar Plot
plot_bar(data[,c()])

# Scatter Plot
plot_scatterplot(data[,c()],by ='var')

# Histogram Plot
plot_histogram(data$var)
# or
plot_histogram(data[,''])
```

**Example**

```{r}
# Bar Plot
plot_bar(data[,c('A1','A4','A5')])

# Scatter Plot
plot_scatterplot(data[,c('A2','A3')],by ='A2')

# Histogram Plot
plot_histogram(data$A2)
# or
plot_histogram(data[,'A2'])
```

6.  **Descriptive Statistics for each variable**

```{r}
summary(data)
```

## **MULTIVARIATE NORMAL DISTRIUBUTION**

### **A. Simulating Multivariate Normal Distribution**

```{r}
# Installing Packages
library(MASS)
library(ggplot2)
library(MVN)
```

Here is the computation for simulating multivariate distribution

```         
# Input Part
n = 
mu = 
sigma =
tol =
empirical =

# Computation Part
data = mvrnorm(n,mu,sigma)
```

**Explaination:**

-   Ref:<https://www.rdocumentation.org/packages/rockchalk/versions/1.8.110/topics/mvrnorm>

-   n =\> a number of samples.

-   mu =\> a mean vector of variables. - sigma =\> a covariance matrix.

**Example:**

```{r}
n = 10
mu = c(0,0)
sigma = matrix(c(10,3,3,2),2,2)
sigma
set.seed(1)
data = mvrnorm(n,mu,sigma)
data
```

### B. Normality Test for multivariate variables using 'energy'

Test H0: data is multivariate normal distribution vs H1: data is not
multivariate normal distribution For conclusion, we will reject H0 if
p-value \< 0.05

```{r}
# computation part
# using multivariate plot to show the chi-square Q-Q plot
results = mvn(data, mvnTest = 'energy', multivariatePlot = 'qq') 
results

# using univariate plot
results_U = mvn(data, mvnTest = 'energy', univariatePlot = 'qqplot')
results_U
```

# CHAPTER 3

## A. ONE SAMPLE T-TEST

### 1. Hypothesis testing : Hotelling's T Square

H0 : Mu = Mu0 vs H1 : Mu =/ Mu0

#### **1.1 Hotelling's T square Manual**

```         
# Input Part
Xbar = matrix(c(),,)
S = matrix(c(),,)
mu = matrix(c(),,)
n = 
p = 
alfa =
n_p = n-p

# Computation Part
## Calculate T Square
T2=n*t(Xbar-mu)%*%solve(S)%*%(Xbar-mu)
paste("Hotelling's T2 is:",T2)

## Calculate Critical Value
T2_cri=(((n-1)*p)/(n-p))*qf(alfa,p,n_p,lower.tail = FALSE)
paste("Critical value: ",T2_cri)

## Conclusion
if(T2 < T2_cri){
  paste("Since T2 = ",T2, "< Critical Value = ",T2_cri,
      "so we cannot reject H0 at the significant level", alfa)
}else if(T2 = T2_cri){
   paste("Since T2 = ",T2, "= Critical Value = ",T2_cri,
      "so we cannot reject H0 at the significant level", alfa)
}else{
  paste("Since T2 = ",T2, "> Critical Value = ",T2_cri,
      "so we reject H0 at the significant level", alfa)
}
```

**Explaination:**

-   Xbar = mean of the sample

-   mu = plausible value for the population mean

-   S = covariance matrix

-   n = number of sample

-   p = number of variable

-   alfa = significant level

-   n_p = number of sample - number of variable

**Example 3.1:**

```{r}
# Input Part
Xbar = matrix(c(4.64,45.4,9.965),3,1)
S = matrix(c(2.879,10.01,-1.81,10.01,199.788,-5.64,-1.81,-5.64,3.628),3,3)
mu = matrix(c(4,50,10),3,1)
n = 20
p = 3
alfa = 0.05
n_p = n-p

# Computation Part
## Calculate T Square
T2=n*t(Xbar-mu)%*%solve(S)%*%(Xbar-mu)
paste("Hotelling's T2 is:",T2)

## Calculate Critical Value
T2_cri=(((n-1)*p)/(n-p))*qf(alfa,p,n_p,lower.tail = FALSE)
paste("Critical value: ",T2_cri)

## Conclusion
if(T2 < T2_cri){
  paste("Since T2 = ",T2, "< Critical Value = ",T2_cri,
      "so we cannot reject H0 at the significant level", alfa)
}else if(T2 == T2_cri){
   paste("Since T2 = ",T2, "= Critical Value = ",T2_cri,
      "so we cannot reject H0 at the significant level", alfa)
}else{
  paste("Since T2 = ",T2, "> Critical Value = ",T2_cri,
      "so we reject H0 at the significant level", alfa)
}

```

#### 1.2 Hotelling's Testing using packages Installing the package:

```{r}
library(DescTools)
library(MASS)
```

**The computation:**

```         
# Input Part
x = matrix(c(),,)
mu0 = c()

# Computation Part
## Hotelling's T2 Test using F distribution
HotellingsT2Test(x,mu=mu0)
## Hotelling's T2 Test using Chi-squared distribution
HotellingsT2Test(x,mu=mu0,test="chi")
```

**Explaination:**

-   x = a numeric dataframe or matrix

-   mu0 = plausible value for the population mean

**Example 3.2:**

```{r}
# Input Part
x=matrix(c(6,10,8,9,6,3),3,2)
x
mu0=c(9,5)

# Computation Part
## Hotelling's T2 Test using F distribution
HotellingsT2Test(x,mu=mu0)
## Hotelling's T2 Test using Chi-squared distribution
HotellingsT2Test(x,mu=mu0,test="chi")

```

### **2. Confidence Regions and Simultaneous Comparisons of Component Means**

#### **2.1 The 100(1-alfa)% Simultaneous T2 Intervals for the two components means**

**The computation:**

```         
# Input Part
Xbar=matrix(c(),,)
S = matrix(c(),,)
n =
p =
alfa =
df1 = 1 - alfa
n_p = n-p

# Computation Part
L1=Xbar[1,1]-(sqrt(((n-1)*p)/(n-p)*qf(df1,p,n_p))*sqrt(S[1,1]/n))
U1=Xbar[1,1]+(sqrt(((n-1)*p)/(n-p)*qf(df1,p,n_p))*sqrt(S[1,1]/n))
paste("The lower bound L1 : ",L1,"/ The upper bound U1 : ",U1)
```

**Example 3.3:**

```{r}
# Input Part
Xbar = matrix(c(4.64,45.4,9.965),3,1)
S = matrix(c(2.879,10.01,-1.81,10.01,199.788,-5.64,-1.81,-5.64,3.628),3,3)
n = 20
p = 3
alfa = 0.05
df1 = 1 - alfa
n_p = n-p

# Computation Part
L1=Xbar[1,1]-(sqrt(((n-1)*p)/(n-p)*qf(df1,p,n_p))*sqrt(S[1,1]/n))
U1=Xbar[1,1]+(sqrt(((n-1)*p)/(n-p)*qf(df1,p,n_p))*sqrt(S[1,1]/n))
paste("The lower bound L1 : ",L1,"/ The upper bound U1 : ",U1)
```

#### 2.2 The simultaneous 100(1-alfa)% Bonferroni Confidence interval

**The Computation:**

```         
# Input Part
Xbar=matrix(c(),,)
S = matrix(c(),,)
n =
p =
alfa =
df1 = 1 - (alfa/(2*p))
df2 = n-1

# Computation Part
L_1=Xbar[1,1]-((qt(df1,df2))*sqrt(S[1,1]/n))
U_1=Xbar[1,1]+((qt(df1,df2))*sqrt(S[1,1]/n))
paste("The lower bound L1 : ",L_1,"/ The upper bound U1 : ",U_1)
```

**Example 3.4:**

```{r}
# Input Part
Xbar = matrix(c(4.64,45.4,9.965),3,1)
S = matrix(c(2.879,10.01,-1.81,10.01,199.788,-5.64,-1.81,-5.64,3.628),3,3)
n = 20
p = 3
alfa = 0.05
df1 = 1 - (alfa/(2*p))
df2 = n-1

# Computation Part
L_1=Xbar[1,1]-((qt(df1,df2))*sqrt(S[1,1]/n))
U_1=Xbar[1,1]+((qt(df1,df2))*sqrt(S[1,1]/n))
paste("The lower bound L1 : ",L_1,"/ The upper bound U1 : ",U_1)
```

## B. COMPARING MEAN VECTORS FROM TWO INDEPENDENT POPULATIONS

### 1. Assumption Testing - Homogeneity of covariance matrices

#### 1.1 Using Package Installing package

```{r}
library(biotools)
```

**The computation:**

```         
# Input Part
## Sample 1
vecmu1 = matrix(c(),,)
Sigma1 = matrix(c(),,)
n1 = 
set.seed(123)
sample1=mvrnorm(n1,vecmu1,Sigma1)

## Sample 2
vecmu2= matrix(c(),,)
Sigma2 = matrix(c(),,)
n2 =
set.seed(321)
sample2=mvrnorm(n2,vecmu2,Sigma2)
head(sample2)

# Computation Part
nrow = n1+n2
c1 = matrix(0,nrow,1)
head(c1)
c1[1:n1]=1
c1[n1+1:nrow]=2
head(c1) #show the first six rows of the c1
tail(c1) #show the last six rows of c1

# Concatenate data 1 and data 2
sample_merge = rbind(sample1,sample2)
sample_merge

results = boxM(data=sample_merge,group=c1)
results
```

**Example:**

```{r}
# Input Part
## Sample 1
vecmu1 = matrix(c(-4,4),2,1)
Sigma1 = matrix(c(16,-2,-2,9),2,2)
n1 = 15
set.seed(123)
sample1=mvrnorm(n1,vecmu1,Sigma1)

## Sample 2
vecmu2= matrix(c(3,2),2,1)
Sigma2 = matrix(c(7,5,5,12),2,2)
n2 = 18
set.seed(321)
sample2=mvrnorm(n2,vecmu2,Sigma2)
head(sample2)

# Computation Part
nrow = n1+n2
c1 = matrix(0,nrow,1)
head(c1)
c1[1:n1]=1
c1[(n1+1):nrow]=2
head(c1) #show the first six rows of the c1
tail(c1) #show the last six rows of c1

# Concatenate data 1 and data 2
sample_merge = rbind(sample1,sample2)
sample_merge

results = boxM(data=sample_merge,group=c1)
results
```

#### 1.2 Manual Way

##### 1.2.1 X2 Approximation The Computation

**The computation, for g = 2**

```         
# Input Part
S1 = matrix(c(),,)
S2 = matrix(c(),,)
n1 =
n2 =
v1 = n1-1
v2 = n2-1
g =
p =
Sp = (v1*S1+v2*s2)/(n1+n2-2)
alfa =
df1 = 1-alfa
df2 = (1/2)*(g-1)*p*(p+1)

# Computation Part
lnM = ((1/2)*((v1*log(det(S1)))+(v2*log(det(S2)))))-((1/2)*(v1+v2)*log(det(Sp)))
paste("lnM: ", lnM)

c1 = ((1/v1)+(1/v2)-(1/(v1+v2)))*(((2*p^2)+(3*p)-1)/(6*(p+1)*(g-1)))
paste("c1: ",c1)

U = -2*(1-c1)*lnM
cri_val = qchisq(df1,df2)

# Conclusion
if(U < cri_val){
    paste("Since U =", U, " < critical value = ", cri_val,", then do not reject H0.")
}else if(U == cri_val){
    paste("Since U =", U, " = critical value = ", cri_val,", then do not reject H0.")
}else{
    paste("Since U =", U, " > critical value = ", cri_val,", then reject H0.")
}
```

**Example:**

```{r}
# Input Part
S1 = matrix(c(2,1,1,6),2,2)
S2 = matrix(c(2,1,1,4),2,2)
n1 = 50
n2 = 50
v1 = n1-1
v2 = n2-1
g = 2
p = 2
Sp = ((v1*S1)+(v2*S2))/(n1+n2-2)
alfa = 0.05
df1 = 1-alfa
df2 = (1/2)*(g-1)*p*(p+1)

# Computation Part
lnM = ((1/2)*((v1*log(det(S1)))+(v2*log(det(S2)))))-((1/2)*(v1+v2)*log(det(Sp)))
paste("lnM: ", lnM)

c1 = ((1/v1)+(1/v2)-(1/(v1+v2)))*(((2*p^2)+(3*p)-1)/(6*(p+1)*(g-1)))
paste("c1: ",c1)

U = -2*(1-c1)*lnM
cri_val = qchisq(df1,df2)

# Conclusion
if(U < cri_val){
    paste("Since U =", U, " < critical value = ", cri_val,", then do not reject H0.")
}else if(U == cri_val){
    paste("Since U =", U, " = critical value = ", cri_val,", then do not reject H0.")
}else{
    paste("Since U =", U, " > critical value = ", cri_val,", then reject H0.")
}
```

##### 1.2.2 F Approximation The Computation (continuity from X2 Approximation):

**The computation:**

```         
# Computation Part
c2 = ((1/v1^2)+(1/v2^2)-(1/(v1+v2)^2))*(((p-1)*(p+2))/(6*(g-1)))
paste("c1: ",c1)
a1 = 1/2*(g-1)*p*(p+1)
a2 = (a1+2)/abs(c2-c1^2)
b1 = (1-c1-(a1/a2))/a1
b2 = (1-c1+(2/a2))/a2

if(c2 > c1^2){
    F = -2*b1*lnM
}else if(c2 < c1^2){
    F = (-2*a2*b2*lnM)/(a1*(1+(2*b2*lnM)))
}else{
    F = NULL
}
cri_val = qf(df1,a1,a2)

# Conclusion
if(is.null (F)==0){
    if(F<cri_val){
        paste("Since F =", F, " < critical value = ", cri_val,", then do not reject H0.")
    }else if(F==cri_val){
        paste("Since F =", F, " = critical value = ", cri_val,", then do not reject H0.")
    }else{
        paste("Since F =", F, " > critical value = ", cri_val,", then reject H0.")
    }
}else{
    print("we cannot conclude the distribution of F.")
}
```

**Continuity example 3.10:**

```{r}
# Computation Part
c2 = ((1/v1^2)+(1/v2^2)-(1/(v1+v2)^2))*(((p-1)*(p+2))/(6*(g-1)))
paste("c1: ",c1)
a1 = 1/2*(g-1)*p*(p+1)
a2 = (a1+2)/abs(c2-c1^2)
b1 = (1-c1-(a1/a2))/a1
b2 = (1-c1+(2/a2))/a2

if(c2 > c1^2){
    F = -2*b1*lnM
}else if(c2 < c1^2){
    F = (-2*a2*b2*lnM)/(a1*(1+(2*b2*lnM)))
}else{
    F = NULL
}
cri_val = qf(df1,a1,a2)

# Conclusion
if(is.null (F)==0){
    if(F<cri_val){
        paste("Since F =", F, " < critical value = ", cri_val,", then do not reject H0.")
    }else if(F==cri_val){
        paste("Since F =", F, " = critical value = ", cri_val,", then do not reject H0.")
    }else{
        paste("Since F =", F, " > critical value = ", cri_val,", then reject H0.")
    }
}else{
    print("we cannot conclude the distribution of F.")
}
```

### 2. Two Sample when Sigma1=Sigma2

#### 2.1 Hotelling's Testing Manual Computation

**The computation**

```         
# Input Part
s1=matrix(c(),,)
s2=matrix(c(),,)
xbar1=matrix(c(),,)
xbar2=matrix(c(),,)
n1=
n2=
p =
Sp=(((n1-1)/(n1+n2-2))*s1)+(((n2-1)/(n1+n2-2))*s2)
alfa =
df1 = 1-alfa
df2 = n1+n2-p-1

# Computation Part
## Calculate T2
T2=t(xbar1-xbar2)%*%solve(((1/n1)+(1/n2))*Sp)%*%(xbar1-xbar2)
paste("The T2 value : ",T2)

## Calculate Critical Value
cri_val=((n1+n2-2)*p)/(n1+n2-p-1)*qf(df1,p,df2)
paste("the critical value : ", cri_val)

## Conclusion
if(T2 < cri_val){
  paste("Since T2 = ",T2, "< Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else if(T2 == cri_val){
   paste("Since T2 = ",T2, "= Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else{
  paste("Since T2 = ",T2, "> Critical Value = ",cri_val,
      "so we reject H0 at the significant level", alfa)
}
```

**Example 3.5:**

```{r}
# Input Part
s1=matrix(c(2,1,1,6),2,2)
s2=matrix(c(2,1,1,4),2,2)
xbar1=matrix(c(8.3,4.1),2,1)
xbar2=matrix(c(10.2,3.9),2,1)
n1= 50
n2= 50
p = 2
Sp=(((n1-1)/(n1+n2-2))*s1)+(((n2-1)/(n1+n2-2))*s2)
alfa = 0.05
df1 = 1-alfa
df2 = n1+n2-p-1

# Computation Part
## Calculate T2
T2=t(xbar1-xbar2)%*%solve(((1/n1)+(1/n2))*Sp)%*%(xbar1-xbar2)
paste("The T2 value : ",T2)

## Calculate Critical Value
cri_val=((n1+n2-p)*2)/(n1+n2-p-1)*qf(df1,p,df2)
paste("the critical value : ", cri_val)

## Conclusion
if(T2 < cri_val){
  paste("Since T2 = ",T2, "< Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else if(T2 == cri_val){
   paste("Since T2 = ",T2, "= Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else{
  paste("Since T2 = ",T2, "> Critical Value = ",cri_val,
      "so we reject H0 at the significant level", alfa)
}
```

#### 2.2 Hypothesis Testing Using Package Installing the package

```{r}
library(corpcor)
library(Hotelling)
```

Simulate 2 samples from two independent samples with common covariance
matrix.

**The computation:**

```         
# Input Part
## Sample 1
vecmu1 = matrix(c(),,)
Sigma1 = matrix(c(),,)
n1 = 
set.seed(123)
sample1=mvrnorm(n1,vecmu1,Sigma1)

## Sample 2
vecmu2= matrix(c(),,)
Sigma2 = matrix(c(),,)
n2 =
set.seed(321)
sample2=mvrnorm(n2,vecmu2,Sigma2)
head(sample2)

# Computation Part
Htest1 = hotelling.test(sample1,sample2,var.equal=TRUE)
Htest1
```

**Explaination:**

-   sample1 = matrix containing data points from sample 1

-   sample2 = matrix containing data points from sample 2

-   var.equal = assumption of the variance, TRUE if equal and FALSE if
    not equal

**Example:**

```{r}
# Input Part
## Sample 1
vecmu1 = matrix(c(-4,4),2,1)
Sigma1 = matrix(c(16,-2,-2,9),2,2)
n1 = 15
set.seed(123)
sample1=mvrnorm(n1,vecmu1,Sigma1)

## Sample 2
vecmu2= matrix(c(3,2),2,1)
Sigma2 = matrix(c(16,-2,-2,9),2,2)
n2 = 18
set.seed(321)
sample2=mvrnorm(n2,vecmu2,Sigma2)
head(sample2)

# Computation Part
Htest1 = hotelling.test(sample1,sample2,var.equal=TRUE)
Htest1
```

#### 2.3 The 100(1-alfa)% simultaneous confidence intervals

**The computation:**

```         
# Input Part
xbar1 = matrix(c(),,)
xbar2 = matrix(c(),,)
S1 = matrix(c(),,)
S2 = matrix(c(),,)
n1 =
n2 =
p =
Sp=(((n1-1)/(n1+n2-2))*s1)+(((n2-1)/(n1+n2-2))*s2)
alfa = 0.05
df1 = 1-alfa
df2 = n1+n2-p-1
c2 = ((n1+n2-2)*2)/(n1+n2-2-1)*qf(df1,p,df2)

# Computation Part
L1=(xbar1[1,1]-xbar2[1,1])-(sqrt(c2)*sqrt(((1/n1)+(1/n2))*Sp[1,1]))
paste("The lower bound L1: ",L1)

U1=(xbar1[1,1]-xbar2[1,1])+(sqrt(c2)*sqrt(((1/n1)+(1/n2))*Sp[1,1]))
paste("The upper bound U1: ",U1)
```

**Example 3.6:**

```{r}
# Input Part
s1=matrix(c(2,1,1,6),2,2)
s2=matrix(c(2,1,1,4),2,2)
xbar1=matrix(c(8.3,4.1),2,1)
xbar2=matrix(c(10.2,3.9),2,1)
n1= 50
n2= 50
p = 2
Sp=(((n1-1)/(n1+n2-2))*s1)+(((n2-1)/(n1+n2-2))*s2)
alfa = 0.05
df1 = 1-alfa
df2 = n1+n2-p-1
c2 = ((n1+n2-2)*2)/(n1+n2-2-1)*qf(df1,p,df2)

# Computation Part
L1=(xbar1[1,1]-xbar2[1,1])-(sqrt(c2)*sqrt(((1/n1)+(1/n2))*Sp[1,1]))
paste("The lower bound L1: ",L1)

U1=(xbar1[1,1]-xbar2[1,1])+(sqrt(c2)*sqrt(((1/n1)+(1/n2))*Sp[1,1]))
paste("The upper bound U1: ",U1)
```

#### 2.4 The Bonferroni Confidence Interval

**The computation**

```         
# Input Part
s1=matrix(c(),,)
s2=matrix(c(),,)
xbar1 = matrix(c(),,)
xbar2 = matrix(c(),,)
n1 =
n2 =
p =
Sp=(((n1-1)/(n1+n2-2))*s1)+(((n2-1)/(n1+n2-2))*s2)
alfa = 0.05
df1 = 1-(alfa/(2*p))
df2 = n1+n2-2

# Computation Part
L1 = (xbar1[1,1]-xbar2[1,1])-(qt(df1,df2)*sqrt(((1/n1)+(1/n2))*Sp[1,1]))
paste("The lower bound L1: ",L1)

U1 = (xbar1[1,1]-xbar2[1,1])+(qt(df1,df2)*sqrt(((1/n1)+(1/n2))*Sp[1,1]))
paste("The lower bound U1: ",U1)
```

**Example 3.7:**

```{r}
# Input Part
s1=matrix(c(2,1,1,6),2,2)
s2=matrix(c(2,1,1,4),2,2)
xbar1=matrix(c(8.3,4.1),2,1)
xbar2=matrix(c(10.2,3.9),2,1)
n1= 50
n2= 50
Sp=(((n1-1)/(n1+n2-2))*s1)+(((n2-1)/(n1+n2-2))*s2)
alfa = 0.05
df1 = 1-(alfa/(2*p))
df2 = n1+n2-2

# Computation Part
L1 = (xbar1[1,1]-xbar2[1,1])-(qt(df1,df2)*sqrt(((1/n1)+(1/n2))*Sp[1,1]))
paste("The lower bound L1: ",L1)

U1 = (xbar1[1,1]-xbar2[1,1])+(qt(df1,df2)*sqrt(((1/n1)+(1/n2))*Sp[1,1]))
paste("The lower bound U1: ",U1)
```

### 3. Two Sample when Sigma1=/Sigma2

#### 3.1 Hotelling's Testing Manual Computation

**The computation**

```         
# Input Part
s1=matrix(c(),,)
s2=matrix(c(),,)
xbar1=matrix(c(),,)
xbar2=matrix(c(),,)
n1=
n2=
s =(1/n1)*s1+(1/n2)*s2
alfa =
p =

# Computation Part
## Calculate Stat-Value
stat_val = t(xbar1-xbar2)%*%solve(s)%*%(xbar1-xbar2)
paste("The Statistical value : ",stat_val)

## Calculate Critical Value
cri_val=qchisq(1-alfa,p)
paste("the critical value : ", cri_val)

## Conclusion
if(stat_val < cri_val){
  paste("Since statistical value = ",stat_val, "< Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else if(stat_val == cri_val){
   paste("Since statistical value = ",stat_val, "= Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else{
  paste("Since statistical value = ",stat_val, "> Critical Value = ",cri_val,
      "so we reject H0 at the significant level", alfa)
}
```

**Example 3.8:**

```{r}
# Input Part
s1= matrix(c(13825.3,23823.4,23823.4,73107.4),2,2)
s2= matrix(c(8632.0,19616.7,19616.7,55964.5),2,2)
xbar1=matrix(c(204.4,556.6),2,1)
xbar2=matrix(c(130.0,355.0),2,1)
n1= 45
n2= 55
s =(1/n1)*s1+(1/n2)*s2
alfa = 0.05
p = 2

# Computation Part
## Calculate Stat-Value
stat_val = t(xbar1-xbar2)%*%solve(s)%*%(xbar1-xbar2)
paste("The Statistical value : ",stat_val)

## Calculate Critical Value
cri_val=qchisq(1-alfa,p)
paste("the critical value : ", cri_val)

## Conclusion
if(stat_val < cri_val){
  paste("Since statistical value = ",stat_val, "< Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else if(stat_val == cri_val){
   paste("Since statistical value = ",stat_val, "= Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else{
  paste("Since statistical value = ",stat_val, "> Critical Value = ",cri_val,
      "so we reject H0 at the significant level", alfa)
}
```

#### 3.2 Hypothesis Testing Using Package Installing the package

```{r}
library(corpcor)
library(Hotelling)
```

Simulate 2 samples from two independent samples with common covariance
matrix

```         
# Input Part
## Sample 1
vecmu1 = matrix(c(),,)
Sigma1 = matrix(c(),,)
n1 = 
set.seed(123)
sample1=mvrnorm(n1,vecmu1,Sigma1)

## Sample 2
vecmu2= matrix(c(),,)
Sigma2 = matrix(c(),,)
n2 =
set.seed(321)
sample2=mvrnorm(n2,vecmu2,Sigma2)
head(sample2)

# Computation Part
Htest2 = hotelling.test(sample1,sample2,var.equal=FALSE)
Htest2
```

**Explaination:**

-   sample1 = matrix containing data points from sample 1

-   sample2 = matrix containing data points from sample 2

-   var.equal = assumption of the variance, TRUE if equal and FALSE if
    not equal

**Example:**

```{r}
# Input Part
## Sample 1
vecmu1 = matrix(c(-4,4),2,1)
Sigma1 = matrix(c(16,-2,-2,9),2,2)
n1 = 15
set.seed(123)
sample1=mvrnorm(n1,vecmu1,Sigma1)

## Sample 2
vecmu2= matrix(c(3,2),2,1)
Sigma2 = matrix(c(7,5,5,12),2,2)
n2 = 18
set.seed(321)
sample2=mvrnorm(n2,vecmu2,Sigma2)
head(sample2)

# Computation Part
Htest2 = hotelling.test(sample1,sample2,var.equal=FALSE)
Htest2
```

#### **3.3 Confidence Interval**

```         
# Input Part
xbar1 = matrix(c(),,)
xbar2 = matrix(c(),,)
S1 = matrix(c(),,)
S2 = matrix(c(),,)
n1 =
n2 =
p =
s =(1/n1)*s1+(1/n2)*s2
alfa = 0.05
df1 = 1-alfa

# Computation Part
L1=(xbar1[1,1]-xbar2[1,1])-(sqrt(qchisq(df1,p))*sqrt(s[1,1]))
paste("The lower bound L1: ",L1)

U1=(xbar1[1,1]-xbar2[1,1])+(sqrt(qchisq(df1,p))*sqrt(s[1,1]))
paste("The upper bound U1: ",U1)
```

**Example:**

```{r}
# Input Part
s1= matrix(c(13825.3,23823.4,23823.4,73107.4),2,2)
s2= matrix(c(8632.0,19616.7,19616.7,55964.5),2,2)
xbar1=matrix(c(204.4,556.6),2,1)
xbar2=matrix(c(130.0,355.0),2,1)
n1= 45
n2= 55
p = 2
s =(1/n1)*s1+(1/n2)*s2
alfa = 0.05
df1 = 1-alfa

# Computation part
L1=(xbar1[1,1]-xbar2[1,1])-(sqrt(qchisq(df1,p))*sqrt(s[1,1]))
paste("The lower bound L1: ",L1)

U1=(xbar1[1,1]-xbar2[1,1])+(sqrt(qchisq(df1,p))*sqrt(s[1,1]))
paste("The upper bound U1: ",U1)
```

## C. PAIRED COMPARISON

### 1.1 Hypothesis Testing Paired Comparison - 2 Dependent Sample Using Package

```{r}
# Install Package
library(DescTools)
```

**The Computation**

```         
# Input Part
data1= matrix(c(),,)
data2= matrix(c(),,)
diff = data1-data2
muH0 = c()

# Computation Part
Htest = HotellingsT2Test(diff, mu=muH0)
```

**Example:**

```{r}
# Input Part
data1= matrix(c(6,6,18,8,11,34,28,71,43,33,20,27,23,64,44,30,75,26,124,54,30,14),11,2)
data2= matrix(c(25,28,36,35,15,44,42,54,34,29,39,15,13,22,29,31,64,30,64,56,20,21),11,2)
diff = data1-data2
muH0 = c(0,0)

# Computation Part
Htest = HotellingsT2Test(diff, mu=muH0)
Htest
```

### 1.2 Hypothesis Testing Paired Comparison - 2 Dependent Sample Manual Way

**The computation**

```         
# Input Part
x1 = matrix(c(),,)
x2 = matrix(c(),,)
d = x1-x2
dmean = colMeans(d)
dbar = matrix(c(dmean[1],dmean[2]),2,1)
sd = cov(d)
n = 
p = 
alfa =
df1 = 1-alfa
df2 = n-p

# Computation Part
## Statistical Value
T2 = n*t(dbar)%*%solve(sd)%*%dbar
paste("The Statistical value : ",T2)

## Critical Value
cri_val=(((n-1)*p)/(n-p))*qf(df1,p,df2)
paste("The Critical value : ",cri_val)

## Conclusion
if(T2 < cri_val){
  paste("Since statistical value = ",T2, "< Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else if(T2 == cri_val){
   paste("Since statistical value = ",T2, "= Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else{
  paste("Since statistical value = ",T2, "> Critical Value = ",cri_val,
      "so we reject H0 at the significant level", alfa)
}
```

**Example:**

```{r}
# Input Part
x1 = matrix(c(6,6,18,8,11,34,28,71,43,33,20,27,23,64,44,30,75,26,124,54,30,14),11,2)
x2 = matrix(c(25,28,36,35,15,44,42,54,34,29,39,15,13,22,29,31,64,30,64,56,20,21),11,2)
d = x1-x2
dmean = colMeans(d)
dbar = matrix(c(dmean[1],dmean[2]),2,1)
sd = cov(d)
n = 11
p = 2
alfa = 0.05
df1 = 1-alfa
df2 = n-p

# Computation Part
## Statistical Value
T2 = n*t(dbar)%*%solve(sd)%*%dbar
paste("The Statistical value : ",T2)

## Critical Value
cri_val=(((n-1)*p)/(n-p))*qf(df1,p,df2)
paste("The Critical value : ",cri_val)

## Conclusion
if(T2 < cri_val){
  paste("Since statistical value = ",T2, "< Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else if(T2 == cri_val){
   paste("Since statistical value = ",T2, "= Critical Value = ",cri_val,
      "so we cannot reject H0 at the significant level", alfa)
}else{
  paste("Since statistical value = ",T2, "> Critical Value = ",cri_val,
      "so we reject H0 at the significant level", alfa)
}
```

### 1.3 The 100(1-alfa)% Confidence Interval

**The computation:**

```         
# Input Part
x1 = matrix(c(),,)
x2 = matrix(c(),,)
d = x1-x2
dmean = colMeans(d)
dbar = matrix(c(dmean[1],dmean[2]),2,1)
sd = cov(d)
n = 
p = 
alfa =
df1 = 1-alfa
df2 = n-p

# Computation Part
L1 = dbar[1,1]-(sqrt(((n-1)*p/(n-p))*qf(df1,p,df2))*sqrt(sd[1,1]/n))
paste("The lower bound L1: ",L1)
U1 = dbar[1,1]+(sqrt(((n-1)*p/(n-p))*qf(df1,p,df2))*sqrt(sd[1,1]/n))
paste("The Upper bound U1: ",U1)
```

**Example:**

```{r}
# Input Part
x1 = matrix(c(6,6,18,8,11,34,28,71,43,33,20,27,23,64,44,30,75,26,124,54,30,14),11,2)
x2 = matrix(c(25,28,36,35,15,44,42,54,34,29,39,15,13,22,29,31,64,30,64,56,20,21),11,2)
d = x1-x2
dmean = colMeans(d)
dbar = matrix(c(dmean[1],dmean[2]),2,1)
sd = cov(d)
n = 11
p = 2
alfa = 0.05
df1 = 1-alfa
df2 = n-p

# Computation Part
L1 = dbar[1,1]-(sqrt(((n-1)*p/(n-p))*qf(df1,p,df2))*sqrt(sd[1,1]/n))
paste("The lower bound L1: ",L1)
U1 = dbar[1,1]+(sqrt(((n-1)*p/(n-p))*qf(df1,p,df2))*sqrt(sd[1,1]/n))
paste("The Upper bound U1: ",U1)
```

### 1.4 The 100(1-alfa)% Bonfferoni Confidence Interval

**The Computation**

```         
# Input Part
x1 = matrix(c(),,)
x2 = matrix(c(),,)
d = x1-x2
dmean = colMeans(d)
dbar = matrix(c(dmean[1],dmean[2]),2,1)
sd = cov(d)
n = 
p = 
alfa =
df1 = 1-(alfa/(2*p))
df2 = n-1

# Computation Part
L1 = dbar[1,1]-(qt(df1,df2)*sqrt(sd[1,1]/n))
paste("The lower bound L1: ",L1)

U1 = dbar[1,1]+(qt(df1,df2)*sqrt(sd[1,1]/n))
paste("The lower bound U1: ",U1)
```

**Example:**

```{r}
# Input Part
x1 = matrix(c(6,6,18,8,11,34,28,71,43,33,20,27,23,64,44,30,75,26,124,54,30,14),11,2)
x2 = matrix(c(25,28,36,35,15,44,42,54,34,29,39,15,13,22,29,31,64,30,64,56,20,21),11,2)
d = x1-x2
dmean = colMeans(d)
dbar = matrix(c(dmean[1],dmean[2]),2,1)
sd = cov(d)
n = 11
p = 2
alfa = 0.05
df1 = 1-(alfa/(2*p))
df2 = n-1

# Computation Part
L1 = dbar[1,1]-(qt(df1,df2)*sqrt(sd[1,1]/n))
paste("The lower bound L1: ",L1)

U1 = dbar[1,1]+(qt(df1,df2)*sqrt(sd[1,1]/n))
paste("The lower bound U1: ",U1)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
